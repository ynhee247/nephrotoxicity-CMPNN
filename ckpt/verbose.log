Fold 0
Using device: cuda
Loading data
Number of tasks = 1
Splitting data with seed 0
Class sizes
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation auc = 0.617378
Epoch 1
Validation auc = 0.644944
Epoch 2
Validation auc = 0.617759
Epoch 3
Validation auc = 0.647866
Epoch 4
Validation auc = 0.669334
Epoch 5
Validation auc = 0.690803
Epoch 6
Validation auc = 0.696519
Epoch 7
Validation auc = 0.686103
Epoch 8
Validation auc = 0.679878
Epoch 9
Validation auc = 0.717607
Epoch 10
Validation auc = 0.713415
Epoch 11
Validation auc = 0.730437
Epoch 12
Validation auc = 0.722180
Epoch 13
Validation auc = 0.734121
Epoch 14
Validation auc = 0.751397
Epoch 15
Validation auc = 0.742124
Epoch 16
Validation auc = 0.761179
Epoch 17
Validation auc = 0.742505
Epoch 18
Validation auc = 0.750254
Epoch 19
Validation auc = 0.727388
Epoch 20
Validation auc = 0.764355
Epoch 21
Validation auc = 0.754446
Epoch 22
Validation auc = 0.761115
Epoch 23
Validation auc = 0.745998
Epoch 24
Validation auc = 0.748349
Epoch 25
Validation auc = 0.751270
Epoch 26
Validation auc = 0.731072
Epoch 27
Validation auc = 0.745173
Epoch 28
Validation auc = 0.732025
Epoch 29
Validation auc = 0.749619
Model 0 best validation auc = 0.764355 on epoch 20
Moving model to cuda
Model 0 test auc = 0.755462
Ensemble metrics: AUC=0.755462, Accuracy=0.679775, Precision=0.685714, Recall=0.750000, F1=0.716418
Ensemble test auc = 0.755462
Fold 1
Using device: cuda
Loading data
Number of tasks = 1
Splitting data with seed 1
Class sizes
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation auc = 0.749745
Epoch 1
Validation auc = 0.753827
Epoch 2
Validation auc = 0.782526
Epoch 3
Validation auc = 0.761352
Epoch 4
Validation auc = 0.768750
Epoch 5
Validation auc = 0.723852
Epoch 6
Validation auc = 0.788520
Epoch 7
Validation auc = 0.797959
Epoch 8
Validation auc = 0.779082
Epoch 9
Validation auc = 0.792347
Epoch 10
Validation auc = 0.779847
Epoch 11
Validation auc = 0.769515
Epoch 12
Validation auc = 0.789031
Epoch 13
Validation auc = 0.810969
Epoch 14
Validation auc = 0.776658
Epoch 15
Validation auc = 0.808801
Epoch 16
Validation auc = 0.794515
Epoch 17
Validation auc = 0.774617
Epoch 18
Validation auc = 0.803699
Epoch 19
Validation auc = 0.760587
Epoch 20
Validation auc = 0.777806
Epoch 21
Validation auc = 0.789668
Epoch 22
Validation auc = 0.785204
Epoch 23
Validation auc = 0.787500
Epoch 24
Validation auc = 0.774681
Epoch 25
Validation auc = 0.799554
Epoch 26
Validation auc = 0.763712
Epoch 27
Validation auc = 0.808865
Epoch 28
Validation auc = 0.794196
Epoch 29
Validation auc = 0.786097
Model 0 best validation auc = 0.810969 on epoch 13
Moving model to cuda
Model 0 test auc = 0.669118
Ensemble metrics: AUC=0.669118, Accuracy=0.584270, Precision=0.652174, Recall=0.588235, F1=0.618557
Ensemble test auc = 0.669118
Fold 2
Using device: cuda
Loading data
Number of tasks = 1
Splitting data with seed 2
Class sizes
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation auc = 0.653030
Epoch 1
Validation auc = 0.670833
Epoch 2
Validation auc = 0.706692
Epoch 3
Validation auc = 0.721465
Epoch 4
Validation auc = 0.707323
Epoch 5
Validation auc = 0.696591
Epoch 6
Validation auc = 0.710354
Epoch 7
Validation auc = 0.707702
Epoch 8
Validation auc = 0.697727
Epoch 9
Validation auc = 0.683586
Epoch 10
Validation auc = 0.695960
Epoch 11
Validation auc = 0.738763
Epoch 12
Validation auc = 0.729419
Epoch 13
Validation auc = 0.702778
Epoch 14
Validation auc = 0.713763
Epoch 15
Validation auc = 0.723485
Epoch 16
Validation auc = 0.702588
Epoch 17
Validation auc = 0.698611
Epoch 18
Validation auc = 0.703283
Epoch 19
Validation auc = 0.698422
Epoch 20
Validation auc = 0.716351
Epoch 21
Validation auc = 0.704672
Epoch 22
Validation auc = 0.701073
Epoch 23
Validation auc = 0.715215
Epoch 24
Validation auc = 0.705177
Epoch 25
Validation auc = 0.708396
Epoch 26
Validation auc = 0.714205
Epoch 27
Validation auc = 0.698169
Epoch 28
Validation auc = 0.708902
Epoch 29
Validation auc = 0.708902
Model 0 best validation auc = 0.738763 on epoch 11
Moving model to cuda
Model 0 test auc = 0.730469
Ensemble metrics: AUC=0.730469, Accuracy=0.606742, Precision=0.754386, Recall=0.434343, F1=0.551282
Ensemble test auc = 0.730469
Fold 3
Using device: cuda
Loading data
Number of tasks = 1
Splitting data with seed 3
Class sizes
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation auc = 0.709254
Epoch 1
Validation auc = 0.726171
Epoch 2
Validation auc = 0.730085
Epoch 3
Validation auc = 0.723646
Epoch 4
Validation auc = 0.726045
Epoch 5
Validation auc = 0.726045
Epoch 6
Validation auc = 0.719985
Epoch 7
Validation auc = 0.747002
Epoch 8
Validation auc = 0.725540
Epoch 9
Validation auc = 0.735892
Epoch 10
Validation auc = 0.756723
Epoch 11
Validation auc = 0.744603
Epoch 12
Validation auc = 0.735892
Epoch 13
Validation auc = 0.776165
Epoch 14
Validation auc = 0.777048
Epoch 15
Validation auc = 0.756723
Epoch 16
Validation auc = 0.777175
Epoch 17
Validation auc = 0.772503
Epoch 18
Validation auc = 0.771241
Epoch 19
Validation auc = 0.758111
Epoch 20
Validation auc = 0.756786
Epoch 21
Validation auc = 0.764676
Epoch 22
Validation auc = 0.761709
Epoch 23
Validation auc = 0.745865
Epoch 24
Validation auc = 0.760258
Epoch 25
Validation auc = 0.757733
Epoch 26
Validation auc = 0.753882
Epoch 27
Validation auc = 0.751483
Epoch 28
Validation auc = 0.749463
Epoch 29
Validation auc = 0.749463
Model 0 best validation auc = 0.777175 on epoch 16
Moving model to cuda
Model 0 test auc = 0.732341
Ensemble metrics: AUC=0.732341, Accuracy=0.657303, Precision=0.772727, Recall=0.525773, F1=0.625767
Ensemble test auc = 0.732341
Fold 4
Using device: cuda
Loading data
Number of tasks = 1
Splitting data with seed 4
Class sizes
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Moving model to cuda
Epoch 0
Validation auc = 0.627296
Epoch 1
Validation auc = 0.657398
Epoch 2
Validation auc = 0.699107
Epoch 3
Validation auc = 0.704209
Epoch 4
Validation auc = 0.717474
Epoch 5
Validation auc = 0.716454
Epoch 6
Validation auc = 0.743622
Epoch 7
Validation auc = 0.752041
Epoch 8
Validation auc = 0.778571
Epoch 9
Validation auc = 0.766709
Epoch 10
Validation auc = 0.781122
Epoch 11
Validation auc = 0.774617
Epoch 12
Validation auc = 0.786097
Epoch 13
Validation auc = 0.741199
Epoch 14
Validation auc = 0.739541
Epoch 15
Validation auc = 0.752551
Epoch 16
Validation auc = 0.735332
Epoch 17
Validation auc = 0.732781
Epoch 18
Validation auc = 0.735395
Epoch 19
Validation auc = 0.729464
Epoch 20
Validation auc = 0.718814
Epoch 21
Validation auc = 0.731569
Epoch 22
Validation auc = 0.704911
Epoch 23
Validation auc = 0.693750
Epoch 24
Validation auc = 0.715880
Epoch 25
Validation auc = 0.727551
Epoch 26
Validation auc = 0.703571
Epoch 27
Validation auc = 0.714031
Epoch 28
Validation auc = 0.720408
Epoch 29
Validation auc = 0.715115
Model 0 best validation auc = 0.786097 on epoch 12
Moving model to cuda
Model 0 test auc = 0.711024
Ensemble metrics: AUC=0.711024, Accuracy=0.578652, Precision=0.491525, Recall=0.794521, F1=0.607330
Ensemble test auc = 0.711024
5-fold cross validation
Seed 0 ==> test auc = 0.755462
Seed 1 ==> test auc = 0.669118
Seed 2 ==> test auc = 0.730469
Seed 3 ==> test auc = 0.732341
Seed 4 ==> test auc = 0.711024
Overall test auc = 0.719683 +/- 0.028943
Fold 0
Fold 0
Using device: cuda
Using device: cuda
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 100
Splitting data with seed 100
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Validation auc = 0.606994
Validation auc = 0.606994
Epoch 1
Epoch 1
Validation auc = 0.676808
Validation auc = 0.676808
Epoch 2
Epoch 2
Validation auc = 0.693347
Validation auc = 0.693347
Epoch 3
Epoch 3
Validation auc = 0.701805
Validation auc = 0.701805
Epoch 4
Epoch 4
Validation auc = 0.705088
Validation auc = 0.705088
Epoch 5
Epoch 5
Validation auc = 0.712789
Validation auc = 0.712789
Epoch 6
Epoch 6
Validation auc = 0.705088
Validation auc = 0.705088
Epoch 7
Epoch 7
Validation auc = 0.711148
Validation auc = 0.711148
Epoch 8
Epoch 8
Validation auc = 0.708749
Validation auc = 0.708749
Epoch 9
Epoch 9
Validation auc = 0.742709
Validation auc = 0.742709
Epoch 10
Epoch 10
Validation auc = 0.741573
Validation auc = 0.741573
Epoch 11
Epoch 11
Validation auc = 0.705088
Validation auc = 0.705088
Epoch 12
Epoch 12
Validation auc = 0.727686
Validation auc = 0.727686
Epoch 13
Epoch 13
Validation auc = 0.706603
Validation auc = 0.706603
Epoch 14
Epoch 14
Validation auc = 0.724151
Validation auc = 0.724151
Epoch 15
Epoch 15
Validation auc = 0.722384
Validation auc = 0.722384
Epoch 16
Epoch 16
Validation auc = 0.734377
Validation auc = 0.734377
Epoch 17
Epoch 17
Validation auc = 0.735513
Validation auc = 0.735513
Epoch 18
Epoch 18
Validation auc = 0.733241
Validation auc = 0.733241
Epoch 19
Epoch 19
Validation auc = 0.743340
Validation auc = 0.743340
Epoch 20
Epoch 20
Validation auc = 0.735576
Validation auc = 0.735576
Epoch 21
Epoch 21
Validation auc = 0.730085
Validation auc = 0.730085
Epoch 22
Epoch 22
Validation auc = 0.736397
Validation auc = 0.736397
Epoch 23
Epoch 23
Validation auc = 0.723583
Validation auc = 0.723583
Epoch 24
Epoch 24
Validation auc = 0.712599
Validation auc = 0.712599
Epoch 25
Epoch 25
Validation auc = 0.743909
Validation auc = 0.743909
Epoch 26
Epoch 26
Validation auc = 0.728065
Validation auc = 0.728065
Epoch 27
Epoch 27
Validation auc = 0.736649
Validation auc = 0.736649
Epoch 28
Epoch 28
Validation auc = 0.720553
Validation auc = 0.720553
Epoch 29
Epoch 29
Validation auc = 0.722573
Validation auc = 0.722573
Model 0 best validation auc = 0.743909 on epoch 25
Model 0 best validation auc = 0.743909 on epoch 25
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.738330
Model 0 test auc = 0.738330
Ensemble metrics: AUC=0.738330, Accuracy=0.651685, Precision=0.637168, Recall=0.774194, F1=0.699029
Ensemble metrics: AUC=0.738330, Accuracy=0.651685, Precision=0.637168, Recall=0.774194, F1=0.699029
Ensemble test auc = 0.738330
Ensemble test auc = 0.738330
Fold 1
Fold 1
Using device: cuda
Using device: cuda
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 101
Splitting data with seed 101
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Validation auc = 0.690676
Validation auc = 0.690676
Epoch 1
Epoch 1
Validation auc = 0.681275
Validation auc = 0.681275
Epoch 2
Epoch 2
Validation auc = 0.684705
Validation auc = 0.684705
Epoch 3
Epoch 3
Validation auc = 0.683689
Validation auc = 0.683689
Epoch 4
Epoch 4
Validation auc = 0.661331
Validation auc = 0.661331
Epoch 5
Epoch 5
Validation auc = 0.673908
Validation auc = 0.673908
Epoch 6
Epoch 6
Validation auc = 0.697027
Validation auc = 0.697027
Epoch 7
Epoch 7
Validation auc = 0.696138
Validation auc = 0.696138
Epoch 8
Epoch 8
Validation auc = 0.700584
Validation auc = 0.700584
Epoch 9
Epoch 9
Validation auc = 0.678100
Validation auc = 0.678100
Epoch 10
Epoch 10
Validation auc = 0.703252
Validation auc = 0.703252
Epoch 11
Epoch 11
Validation auc = 0.693471
Validation auc = 0.693471
Epoch 12
Epoch 12
Validation auc = 0.684197
Validation auc = 0.684197
Epoch 13
Epoch 13
Validation auc = 0.699060
Validation auc = 0.699060
Epoch 14
Epoch 14
Validation auc = 0.697472
Validation auc = 0.697472
Epoch 15
Epoch 15
Validation auc = 0.684388
Validation auc = 0.684388
Epoch 16
Epoch 16
Validation auc = 0.693725
Validation auc = 0.693725
Epoch 17
Epoch 17
Validation auc = 0.692899
Validation auc = 0.692899
Epoch 18
Epoch 18
Validation auc = 0.716527
Validation auc = 0.716527
Epoch 19
Epoch 19
Validation auc = 0.708778
Validation auc = 0.708778
Epoch 20
Epoch 20
Validation auc = 0.710493
Validation auc = 0.710493
Epoch 21
Epoch 21
Validation auc = 0.700584
Validation auc = 0.700584
Epoch 22
Epoch 22
Validation auc = 0.719449
Validation auc = 0.719449
Epoch 23
Epoch 23
Validation auc = 0.691502
Validation auc = 0.691502
Epoch 24
Epoch 24
Validation auc = 0.692391
Validation auc = 0.692391
Epoch 25
Epoch 25
Validation auc = 0.679243
Validation auc = 0.679243
Epoch 26
Epoch 26
Validation auc = 0.700330
Validation auc = 0.700330
Epoch 27
Epoch 27
Validation auc = 0.721481
Validation auc = 0.721481
Epoch 28
Epoch 28
Validation auc = 0.716527
Validation auc = 0.716527
Epoch 29
Epoch 29
Validation auc = 0.714431
Validation auc = 0.714431
Model 0 best validation auc = 0.721481 on epoch 27
Model 0 best validation auc = 0.721481 on epoch 27
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.741768
Model 0 test auc = 0.741768
Ensemble metrics: AUC=0.741768, Accuracy=0.651685, Precision=0.610000, Recall=0.726190, F1=0.663043
Ensemble metrics: AUC=0.741768, Accuracy=0.651685, Precision=0.610000, Recall=0.726190, F1=0.663043
Ensemble test auc = 0.741768
Ensemble test auc = 0.741768
Fold 2
Fold 2
Using device: cuda
Using device: cuda
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 102
Splitting data with seed 102
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Validation auc = 0.627275
Validation auc = 0.627275
Epoch 1
Epoch 1
Validation auc = 0.627275
Validation auc = 0.627275
Epoch 2
Epoch 2
Validation auc = 0.632331
Validation auc = 0.632331
Epoch 3
Epoch 3
Validation auc = 0.656598
Validation auc = 0.656598
Epoch 4
Epoch 4
Validation auc = 0.660137
Validation auc = 0.660137
Epoch 5
Epoch 5
Validation auc = 0.667088
Validation auc = 0.667088
Epoch 6
Epoch 6
Validation auc = 0.648761
Validation auc = 0.648761
Epoch 7
Epoch 7
Validation auc = 0.658241
Validation auc = 0.658241
Epoch 8
Epoch 8
Validation auc = 0.637765
Validation auc = 0.637765
Epoch 9
Epoch 9
Validation auc = 0.683771
Validation auc = 0.683771
Epoch 10
Epoch 10
Validation auc = 0.661148
Validation auc = 0.661148
Epoch 11
Epoch 11
Validation auc = 0.673787
Validation auc = 0.673787
Epoch 12
Epoch 12
Validation auc = 0.705763
Validation auc = 0.705763
Epoch 13
Epoch 13
Validation auc = 0.688069
Validation auc = 0.688069
Epoch 14
Epoch 14
Validation auc = 0.717897
Validation auc = 0.717897
Epoch 15
Epoch 15
Validation auc = 0.709745
Validation auc = 0.709745
Epoch 16
Epoch 16
Validation auc = 0.723964
Validation auc = 0.723964
Epoch 17
Epoch 17
Validation auc = 0.724722
Validation auc = 0.724722
Epoch 18
Epoch 18
Validation auc = 0.727313
Validation auc = 0.727313
Epoch 19
Epoch 19
Validation auc = 0.746145
Validation auc = 0.746145
Epoch 20
Epoch 20
Validation auc = 0.741595
Validation auc = 0.741595
Epoch 21
Epoch 21
Validation auc = 0.733001
Validation auc = 0.733001
Epoch 22
Epoch 22
Validation auc = 0.746777
Validation auc = 0.746777
Epoch 23
Epoch 23
Validation auc = 0.741405
Validation auc = 0.741405
Epoch 24
Epoch 24
Validation auc = 0.743238
Validation auc = 0.743238
Epoch 25
Epoch 25
Validation auc = 0.742417
Validation auc = 0.742417
Epoch 26
Epoch 26
Validation auc = 0.746208
Validation auc = 0.746208
Epoch 27
Epoch 27
Validation auc = 0.748231
Validation auc = 0.748231
Epoch 28
Epoch 28
Validation auc = 0.747915
Validation auc = 0.747915
Epoch 29
Epoch 29
Validation auc = 0.745576
Validation auc = 0.745576
Model 0 best validation auc = 0.748231 on epoch 27
Model 0 best validation auc = 0.748231 on epoch 27
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.758526
Model 0 test auc = 0.758526
Ensemble metrics: AUC=0.758526, Accuracy=0.668539, Precision=0.725275, Recall=0.660000, F1=0.691099
Ensemble metrics: AUC=0.758526, Accuracy=0.668539, Precision=0.725275, Recall=0.660000, F1=0.691099
Ensemble test auc = 0.758526
Ensemble test auc = 0.758526
Fold 3
Fold 3
Using device: cuda
Using device: cuda
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 103
Splitting data with seed 103
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Validation auc = 0.685606
Validation auc = 0.685606
Epoch 1
Epoch 1
Validation auc = 0.726062
Validation auc = 0.726062
Epoch 2
Epoch 2
Validation auc = 0.732150
Validation auc = 0.732150
Epoch 3
Epoch 3
Validation auc = 0.758402
Validation auc = 0.758402
Epoch 4
Epoch 4
Validation auc = 0.776157
Validation auc = 0.776157
Epoch 5
Epoch 5
Validation auc = 0.782118
Validation auc = 0.782118
Epoch 6
Epoch 6
Validation auc = 0.773874
Validation auc = 0.773874
Epoch 7
Epoch 7
Validation auc = 0.781737
Validation auc = 0.781737
Epoch 8
Epoch 8
Validation auc = 0.785542
Validation auc = 0.785542
Epoch 9
Epoch 9
Validation auc = 0.769816
Validation auc = 0.769816
Epoch 10
Epoch 10
Validation auc = 0.782625
Validation auc = 0.782625
Epoch 11
Epoch 11
Validation auc = 0.772606
Validation auc = 0.772606
Epoch 12
Epoch 12
Validation auc = 0.761953
Validation auc = 0.761953
Epoch 13
Epoch 13
Validation auc = 0.754471
Validation auc = 0.754471
Epoch 14
Epoch 14
Validation auc = 0.781484
Validation auc = 0.781484
Epoch 15
Epoch 15
Validation auc = 0.786303
Validation auc = 0.786303
Epoch 16
Epoch 16
Validation auc = 0.774889
Validation auc = 0.774889
Epoch 17
Epoch 17
Validation auc = 0.774128
Validation auc = 0.774128
Epoch 18
Epoch 18
Validation auc = 0.765377
Validation auc = 0.765377
Epoch 19
Epoch 19
Validation auc = 0.754344
Validation auc = 0.754344
Epoch 20
Epoch 20
Validation auc = 0.750793
Validation auc = 0.750793
Epoch 21
Epoch 21
Validation auc = 0.768421
Validation auc = 0.768421
Epoch 22
Epoch 22
Validation auc = 0.787571
Validation auc = 0.787571
Epoch 23
Epoch 23
Validation auc = 0.759163
Validation auc = 0.759163
Epoch 24
Epoch 24
Validation auc = 0.763221
Validation auc = 0.763221
Epoch 25
Epoch 25
Validation auc = 0.766519
Validation auc = 0.766519
Epoch 26
Epoch 26
Validation auc = 0.762080
Validation auc = 0.762080
Epoch 27
Epoch 27
Validation auc = 0.776157
Validation auc = 0.776157
Epoch 28
Epoch 28
Validation auc = 0.767914
Validation auc = 0.767914
Epoch 29
Epoch 29
Validation auc = 0.770197
Validation auc = 0.770197
Model 0 best validation auc = 0.787571 on epoch 22
Model 0 best validation auc = 0.787571 on epoch 22
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.735391
Model 0 test auc = 0.735391
Ensemble metrics: AUC=0.735391, Accuracy=0.679775, Precision=0.675676, Recall=0.781250, F1=0.724638
Ensemble metrics: AUC=0.735391, Accuracy=0.679775, Precision=0.675676, Recall=0.781250, F1=0.724638
Ensemble test auc = 0.735391
Ensemble test auc = 0.735391
Fold 4
Fold 4
Using device: cuda
Using device: cuda
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 104
Splitting data with seed 104
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Validation auc = 0.640278
Validation auc = 0.640278
Epoch 1
Epoch 1
Validation auc = 0.679040
Validation auc = 0.679040
Epoch 2
Epoch 2
Validation auc = 0.707828
Validation auc = 0.707828
Epoch 3
Epoch 3
Validation auc = 0.703409
Validation auc = 0.703409
Epoch 4
Epoch 4
Validation auc = 0.721338
Validation auc = 0.721338
Epoch 5
Epoch 5
Validation auc = 0.713889
Validation auc = 0.713889
Epoch 6
Epoch 6
Validation auc = 0.710985
Validation auc = 0.710985
Epoch 7
Epoch 7
Validation auc = 0.713763
Validation auc = 0.713763
Epoch 8
Epoch 8
Validation auc = 0.699116
Validation auc = 0.699116
Epoch 9
Epoch 9
Validation auc = 0.733586
Validation auc = 0.733586
Epoch 10
Epoch 10
Validation auc = 0.723232
Validation auc = 0.723232
Epoch 11
Epoch 11
Validation auc = 0.684596
Validation auc = 0.684596
Epoch 12
Epoch 12
Validation auc = 0.715025
Validation auc = 0.715025
Epoch 13
Epoch 13
Validation auc = 0.730303
Validation auc = 0.730303
Epoch 14
Epoch 14
Validation auc = 0.718434
Validation auc = 0.718434
Epoch 15
Epoch 15
Validation auc = 0.723737
Validation auc = 0.723737
Epoch 16
Epoch 16
Validation auc = 0.707955
Validation auc = 0.707955
Epoch 17
Epoch 17
Validation auc = 0.700884
Validation auc = 0.700884
Epoch 18
Epoch 18
Validation auc = 0.709596
Validation auc = 0.709596
Epoch 19
Epoch 19
Validation auc = 0.694949
Validation auc = 0.694949
Epoch 20
Epoch 20
Validation auc = 0.692866
Validation auc = 0.692866
Epoch 21
Epoch 21
Validation auc = 0.707828
Validation auc = 0.707828
Epoch 22
Epoch 22
Validation auc = 0.692929
Validation auc = 0.692929
Epoch 23
Epoch 23
Validation auc = 0.685164
Validation auc = 0.685164
Epoch 24
Epoch 24
Validation auc = 0.702273
Validation auc = 0.702273
Epoch 25
Epoch 25
Validation auc = 0.699937
Validation auc = 0.699937
Epoch 26
Epoch 26
Validation auc = 0.698674
Validation auc = 0.698674
Epoch 27
Epoch 27
Validation auc = 0.703977
Validation auc = 0.703977
Epoch 28
Epoch 28
Validation auc = 0.697601
Validation auc = 0.697601
Epoch 29
Epoch 29
Validation auc = 0.703472
Validation auc = 0.703472
Model 0 best validation auc = 0.733586 on epoch 9
Model 0 best validation auc = 0.733586 on epoch 9
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.711633
Model 0 test auc = 0.711633
Ensemble metrics: AUC=0.711633, Accuracy=0.640449, Precision=0.598291, Recall=0.804598, F1=0.686275
Ensemble metrics: AUC=0.711633, Accuracy=0.640449, Precision=0.598291, Recall=0.804598, F1=0.686275
Ensemble test auc = 0.711633
Ensemble test auc = 0.711633
5-fold cross validation
5-fold cross validation
Seed 100 ==> test auc = 0.738330
Seed 100 ==> test auc = 0.738330
Seed 101 ==> test auc = 0.741768
Seed 101 ==> test auc = 0.741768
Seed 102 ==> test auc = 0.758526
Seed 102 ==> test auc = 0.758526
Seed 103 ==> test auc = 0.735391
Seed 103 ==> test auc = 0.735391
Seed 104 ==> test auc = 0.711633
Seed 104 ==> test auc = 0.711633
Overall test auc = 0.737130 +/- 0.015059
Overall test auc = 0.737130 +/- 0.015059
Fold 0
Fold 0
Fold 0
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 200
Splitting data with seed 200
Splitting data with seed 200
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.648466
Validation auc = 0.648466
Validation auc = 0.648466
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.713631
Validation auc = 0.713631
Validation auc = 0.713631
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.724322
Validation auc = 0.724322
Validation auc = 0.724322
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.723304
Validation auc = 0.723304
Validation auc = 0.723304
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.735777
Validation auc = 0.735777
Validation auc = 0.735777
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.732086
Validation auc = 0.732086
Validation auc = 0.732086
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.724068
Validation auc = 0.724068
Validation auc = 0.724068
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.743286
Validation auc = 0.743286
Validation auc = 0.743286
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.742013
Validation auc = 0.742013
Validation auc = 0.742013
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.735522
Validation auc = 0.735522
Validation auc = 0.735522
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.739723
Validation auc = 0.739723
Validation auc = 0.739723
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.754614
Validation auc = 0.754614
Validation auc = 0.754614
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.757159
Validation auc = 0.757159
Validation auc = 0.757159
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.768487
Validation auc = 0.768487
Validation auc = 0.768487
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.760341
Validation auc = 0.760341
Validation auc = 0.760341
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.743795
Validation auc = 0.743795
Validation auc = 0.743795
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.750795
Validation auc = 0.750795
Validation auc = 0.750795
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.731322
Validation auc = 0.731322
Validation auc = 0.731322
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.742777
Validation auc = 0.742777
Validation auc = 0.742777
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.721649
Validation auc = 0.721649
Validation auc = 0.721649
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.742268
Validation auc = 0.742268
Validation auc = 0.742268
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.762887
Validation auc = 0.762887
Validation auc = 0.762887
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.751814
Validation auc = 0.751814
Validation auc = 0.751814
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.758941
Validation auc = 0.758941
Validation auc = 0.758941
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.742141
Validation auc = 0.742141
Validation auc = 0.742141
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.732468
Validation auc = 0.732468
Validation auc = 0.732468
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.741377
Validation auc = 0.741377
Validation auc = 0.741377
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.738704
Validation auc = 0.738704
Validation auc = 0.738704
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.749905
Validation auc = 0.749905
Validation auc = 0.749905
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.744241
Validation auc = 0.744241
Validation auc = 0.744241
Model 0 best validation auc = 0.768487 on epoch 13
Model 0 best validation auc = 0.768487 on epoch 13
Model 0 best validation auc = 0.768487 on epoch 13
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.748104
Model 0 test auc = 0.748104
Model 0 test auc = 0.748104
Ensemble metrics: AUC=0.748104, Accuracy=0.691011, Precision=0.666667, Recall=0.804348, F1=0.729064
Ensemble metrics: AUC=0.748104, Accuracy=0.691011, Precision=0.666667, Recall=0.804348, F1=0.729064
Ensemble metrics: AUC=0.748104, Accuracy=0.691011, Precision=0.666667, Recall=0.804348, F1=0.729064
Ensemble test auc = 0.748104
Ensemble test auc = 0.748104
Ensemble test auc = 0.748104
Fold 1
Fold 1
Fold 1
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 201
Splitting data with seed 201
Splitting data with seed 201
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.584065
Validation auc = 0.584065
Validation auc = 0.584065
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.644648
Validation auc = 0.644648
Validation auc = 0.644648
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.618811
Validation auc = 0.618811
Validation auc = 0.618811
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.653557
Validation auc = 0.653557
Validation auc = 0.653557
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.663358
Validation auc = 0.663358
Validation auc = 0.663358
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.660303
Validation auc = 0.660303
Validation auc = 0.660303
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.675830
Validation auc = 0.675830
Validation auc = 0.675830
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.670230
Validation auc = 0.670230
Validation auc = 0.670230
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.684485
Validation auc = 0.684485
Validation auc = 0.684485
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.679140
Validation auc = 0.679140
Validation auc = 0.679140
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.696958
Validation auc = 0.696958
Validation auc = 0.696958
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.682067
Validation auc = 0.682067
Validation auc = 0.682067
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.696194
Validation auc = 0.696194
Validation auc = 0.696194
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.685503
Validation auc = 0.685503
Validation auc = 0.685503
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.693394
Validation auc = 0.693394
Validation auc = 0.693394
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.699885
Validation auc = 0.699885
Validation auc = 0.699885
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.668321
Validation auc = 0.668321
Validation auc = 0.668321
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.688049
Validation auc = 0.688049
Validation auc = 0.688049
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.693967
Validation auc = 0.693967
Validation auc = 0.693967
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.697913
Validation auc = 0.697913
Validation auc = 0.697913
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.710322
Validation auc = 0.710322
Validation auc = 0.710322
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.704340
Validation auc = 0.704340
Validation auc = 0.704340
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.693013
Validation auc = 0.693013
Validation auc = 0.693013
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.703513
Validation auc = 0.703513
Validation auc = 0.703513
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.684740
Validation auc = 0.684740
Validation auc = 0.684740
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.688113
Validation auc = 0.688113
Validation auc = 0.688113
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.684358
Validation auc = 0.684358
Validation auc = 0.684358
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.693840
Validation auc = 0.693840
Validation auc = 0.693840
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.693904
Validation auc = 0.693904
Validation auc = 0.693904
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.683340
Validation auc = 0.683340
Validation auc = 0.683340
Model 0 best validation auc = 0.710322 on epoch 20
Model 0 best validation auc = 0.710322 on epoch 20
Model 0 best validation auc = 0.710322 on epoch 20
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.648261
Model 0 test auc = 0.648261
Model 0 test auc = 0.648261
Ensemble metrics: AUC=0.648261, Accuracy=0.589888, Precision=0.631579, Recall=0.516129, F1=0.568047
Ensemble metrics: AUC=0.648261, Accuracy=0.589888, Precision=0.631579, Recall=0.516129, F1=0.568047
Ensemble metrics: AUC=0.648261, Accuracy=0.589888, Precision=0.631579, Recall=0.516129, F1=0.568047
Ensemble test auc = 0.648261
Ensemble test auc = 0.648261
Ensemble test auc = 0.648261
Fold 2
Fold 2
Fold 2
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 202
Splitting data with seed 202
Splitting data with seed 202
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.678571
Validation auc = 0.678571
Validation auc = 0.678571
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.709347
Validation auc = 0.709347
Validation auc = 0.709347
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.714666
Validation auc = 0.714666
Validation auc = 0.714666
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.730750
Validation auc = 0.730750
Validation auc = 0.730750
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.747214
Validation auc = 0.747214
Validation auc = 0.747214
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.740122
Validation auc = 0.740122
Validation auc = 0.740122
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.739868
Validation auc = 0.739868
Validation auc = 0.739868
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.714792
Validation auc = 0.714792
Validation auc = 0.714792
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.705800
Validation auc = 0.705800
Validation auc = 0.705800
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.726444
Validation auc = 0.726444
Validation auc = 0.726444
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.693642
Validation auc = 0.693642
Validation auc = 0.693642
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.692882
Validation auc = 0.692882
Validation auc = 0.692882
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.713273
Validation auc = 0.713273
Validation auc = 0.713273
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.713526
Validation auc = 0.713526
Validation auc = 0.713526
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.750127
Validation auc = 0.750127
Validation auc = 0.750127
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.705420
Validation auc = 0.705420
Validation auc = 0.705420
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.714286
Validation auc = 0.714286
Validation auc = 0.714286
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.702381
Validation auc = 0.702381
Validation auc = 0.702381
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.723658
Validation auc = 0.723658
Validation auc = 0.723658
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.721948
Validation auc = 0.721948
Validation auc = 0.721948
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.694212
Validation auc = 0.694212
Validation auc = 0.694212
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.708713
Validation auc = 0.708713
Validation auc = 0.708713
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.708080
Validation auc = 0.708080
Validation auc = 0.708080
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.689970
Validation auc = 0.689970
Validation auc = 0.689970
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.727710
Validation auc = 0.727710
Validation auc = 0.727710
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.706814
Validation auc = 0.706814
Validation auc = 0.706814
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.710993
Validation auc = 0.710993
Validation auc = 0.710993
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.708270
Validation auc = 0.708270
Validation auc = 0.708270
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.704661
Validation auc = 0.704661
Validation auc = 0.704661
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.698772
Validation auc = 0.698772
Validation auc = 0.698772
Model 0 best validation auc = 0.750127 on epoch 14
Model 0 best validation auc = 0.750127 on epoch 14
Model 0 best validation auc = 0.750127 on epoch 14
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.724216
Model 0 test auc = 0.724216
Model 0 test auc = 0.724216
Ensemble metrics: AUC=0.724216, Accuracy=0.640449, Precision=0.689189, Recall=0.554348, F1=0.614458
Ensemble metrics: AUC=0.724216, Accuracy=0.640449, Precision=0.689189, Recall=0.554348, F1=0.614458
Ensemble metrics: AUC=0.724216, Accuracy=0.640449, Precision=0.689189, Recall=0.554348, F1=0.614458
Ensemble test auc = 0.724216
Ensemble test auc = 0.724216
Ensemble test auc = 0.724216
Fold 3
Fold 3
Fold 3
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 203
Splitting data with seed 203
Splitting data with seed 203
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.602248
Validation auc = 0.602248
Validation auc = 0.602248
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.612227
Validation auc = 0.612227
Validation auc = 0.612227
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.635089
Validation auc = 0.635089
Validation auc = 0.635089
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.641026
Validation auc = 0.641026
Validation auc = 0.641026
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.643299
Validation auc = 0.643299
Validation auc = 0.643299
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.654288
Validation auc = 0.654288
Validation auc = 0.654288
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.665151
Validation auc = 0.665151
Validation auc = 0.665151
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.654036
Validation auc = 0.654036
Validation auc = 0.654036
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.655046
Validation auc = 0.655046
Validation auc = 0.655046
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.662498
Validation auc = 0.662498
Validation auc = 0.662498
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.676898
Validation auc = 0.676898
Validation auc = 0.676898
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.691424
Validation auc = 0.691424
Validation auc = 0.691424
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.696981
Validation auc = 0.696981
Validation auc = 0.696981
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.714412
Validation auc = 0.714412
Validation auc = 0.714412
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.725527
Validation auc = 0.725527
Validation auc = 0.725527
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.726412
Validation auc = 0.726412
Validation auc = 0.726412
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.718201
Validation auc = 0.718201
Validation auc = 0.718201
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.734622
Validation auc = 0.734622
Validation auc = 0.734622
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.733485
Validation auc = 0.733485
Validation auc = 0.733485
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.729064
Validation auc = 0.729064
Validation auc = 0.729064
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.733485
Validation auc = 0.733485
Validation auc = 0.733485
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.730453
Validation auc = 0.730453
Validation auc = 0.730453
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.730706
Validation auc = 0.730706
Validation auc = 0.730706
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.732727
Validation auc = 0.732727
Validation auc = 0.732727
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.735380
Validation auc = 0.735380
Validation auc = 0.735380
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.736390
Validation auc = 0.736390
Validation auc = 0.736390
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.742516
Validation auc = 0.742516
Validation auc = 0.742516
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.741632
Validation auc = 0.741632
Validation auc = 0.741632
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.744474
Validation auc = 0.744474
Validation auc = 0.744474
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.736769
Validation auc = 0.736769
Validation auc = 0.736769
Model 0 best validation auc = 0.744474 on epoch 28
Model 0 best validation auc = 0.744474 on epoch 28
Model 0 best validation auc = 0.744474 on epoch 28
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.772992
Model 0 test auc = 0.772992
Model 0 test auc = 0.772992
Ensemble metrics: AUC=0.772992, Accuracy=0.691011, Precision=0.656250, Recall=0.741176, F1=0.696133
Ensemble metrics: AUC=0.772992, Accuracy=0.691011, Precision=0.656250, Recall=0.741176, F1=0.696133
Ensemble metrics: AUC=0.772992, Accuracy=0.691011, Precision=0.656250, Recall=0.741176, F1=0.696133
Ensemble test auc = 0.772992
Ensemble test auc = 0.772992
Ensemble test auc = 0.772992
Fold 4
Fold 4
Fold 4
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 204
Splitting data with seed 204
Splitting data with seed 204
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.663378
Validation auc = 0.663378
Validation auc = 0.663378
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.679317
Validation auc = 0.679317
Validation auc = 0.679317
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.629855
Validation auc = 0.629855
Validation auc = 0.629855
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.685515
Validation auc = 0.685515
Validation auc = 0.685515
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.681720
Validation auc = 0.681720
Validation auc = 0.681720
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.710057
Validation auc = 0.710057
Validation auc = 0.710057
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.705503
Validation auc = 0.705503
Validation auc = 0.705503
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.709424
Validation auc = 0.709424
Validation auc = 0.709424
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.703352
Validation auc = 0.703352
Validation auc = 0.703352
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.702720
Validation auc = 0.702720
Validation auc = 0.702720
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.676660
Validation auc = 0.676660
Validation auc = 0.676660
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.675648
Validation auc = 0.675648
Validation auc = 0.675648
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.680582
Validation auc = 0.680582
Validation auc = 0.680582
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.666034
Validation auc = 0.666034
Validation auc = 0.666034
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.620999
Validation auc = 0.620999
Validation auc = 0.620999
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.648577
Validation auc = 0.648577
Validation auc = 0.648577
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.662366
Validation auc = 0.662366
Validation auc = 0.662366
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.680013
Validation auc = 0.680013
Validation auc = 0.680013
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.662492
Validation auc = 0.662492
Validation auc = 0.662492
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.638077
Validation auc = 0.638077
Validation auc = 0.638077
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.646363
Validation auc = 0.646363
Validation auc = 0.646363
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.681720
Validation auc = 0.681720
Validation auc = 0.681720
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.659140
Validation auc = 0.659140
Validation auc = 0.659140
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.684503
Validation auc = 0.684503
Validation auc = 0.684503
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.674130
Validation auc = 0.674130
Validation auc = 0.674130
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.647944
Validation auc = 0.647944
Validation auc = 0.647944
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.659772
Validation auc = 0.659772
Validation auc = 0.659772
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.670145
Validation auc = 0.670145
Validation auc = 0.670145
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.665085
Validation auc = 0.665085
Validation auc = 0.665085
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.659140
Validation auc = 0.659140
Validation auc = 0.659140
Model 0 best validation auc = 0.710057 on epoch 5
Model 0 best validation auc = 0.710057 on epoch 5
Model 0 best validation auc = 0.710057 on epoch 5
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.733995
Model 0 test auc = 0.733995
Model 0 test auc = 0.733995
Ensemble metrics: AUC=0.733995, Accuracy=0.646067, Precision=0.793103, Recall=0.474227, F1=0.593548
Ensemble metrics: AUC=0.733995, Accuracy=0.646067, Precision=0.793103, Recall=0.474227, F1=0.593548
Ensemble metrics: AUC=0.733995, Accuracy=0.646067, Precision=0.793103, Recall=0.474227, F1=0.593548
Ensemble test auc = 0.733995
Ensemble test auc = 0.733995
Ensemble test auc = 0.733995
5-fold cross validation
5-fold cross validation
5-fold cross validation
Seed 200 ==> test auc = 0.748104
Seed 200 ==> test auc = 0.748104
Seed 200 ==> test auc = 0.748104
Seed 201 ==> test auc = 0.648261
Seed 201 ==> test auc = 0.648261
Seed 201 ==> test auc = 0.648261
Seed 202 ==> test auc = 0.724216
Seed 202 ==> test auc = 0.724216
Seed 202 ==> test auc = 0.724216
Seed 203 ==> test auc = 0.772992
Seed 203 ==> test auc = 0.772992
Seed 203 ==> test auc = 0.772992
Seed 204 ==> test auc = 0.733995
Seed 204 ==> test auc = 0.733995
Seed 204 ==> test auc = 0.733995
Overall test auc = 0.725514 +/- 0.041967
Overall test auc = 0.725514 +/- 0.041967
Overall test auc = 0.725514 +/- 0.041967
Fold 0
Fold 0
Fold 0
Fold 0
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 300
Splitting data with seed 300
Splitting data with seed 300
Splitting data with seed 300
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.646910
Validation auc = 0.646910
Validation auc = 0.646910
Validation auc = 0.646910
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.675912
Validation auc = 0.675912
Validation auc = 0.675912
Validation auc = 0.675912
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.678698
Validation auc = 0.678698
Validation auc = 0.678698
Validation auc = 0.678698
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.677812
Validation auc = 0.677812
Validation auc = 0.677812
Validation auc = 0.677812
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.688703
Validation auc = 0.688703
Validation auc = 0.688703
Validation auc = 0.688703
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.670466
Validation auc = 0.670466
Validation auc = 0.670466
Validation auc = 0.670466
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.725304
Validation auc = 0.725304
Validation auc = 0.725304
Validation auc = 0.725304
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.705547
Validation auc = 0.705547
Validation auc = 0.705547
Validation auc = 0.705547
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.732016
Validation auc = 0.732016
Validation auc = 0.732016
Validation auc = 0.732016
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.719605
Validation auc = 0.719605
Validation auc = 0.719605
Validation auc = 0.719605
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.725811
Validation auc = 0.725811
Validation auc = 0.725811
Validation auc = 0.725811
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.720365
Validation auc = 0.720365
Validation auc = 0.720365
Validation auc = 0.720365
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.728723
Validation auc = 0.728723
Validation auc = 0.728723
Validation auc = 0.728723
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.742401
Validation auc = 0.742401
Validation auc = 0.742401
Validation auc = 0.742401
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.732396
Validation auc = 0.732396
Validation auc = 0.732396
Validation auc = 0.732396
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.720365
Validation auc = 0.720365
Validation auc = 0.720365
Validation auc = 0.720365
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.726317
Validation auc = 0.726317
Validation auc = 0.726317
Validation auc = 0.726317
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.714792
Validation auc = 0.714792
Validation auc = 0.714792
Validation auc = 0.714792
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.724544
Validation auc = 0.724544
Validation auc = 0.724544
Validation auc = 0.724544
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.714286
Validation auc = 0.714286
Validation auc = 0.714286
Validation auc = 0.714286
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.724544
Validation auc = 0.724544
Validation auc = 0.724544
Validation auc = 0.724544
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.724734
Validation auc = 0.724734
Validation auc = 0.724734
Validation auc = 0.724734
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.718655
Validation auc = 0.718655
Validation auc = 0.718655
Validation auc = 0.718655
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.717135
Validation auc = 0.717135
Validation auc = 0.717135
Validation auc = 0.717135
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.721821
Validation auc = 0.721821
Validation auc = 0.721821
Validation auc = 0.721821
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.717452
Validation auc = 0.717452
Validation auc = 0.717452
Validation auc = 0.717452
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.718148
Validation auc = 0.718148
Validation auc = 0.718148
Validation auc = 0.718148
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.723404
Validation auc = 0.723404
Validation auc = 0.723404
Validation auc = 0.723404
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.712323
Validation auc = 0.712323
Validation auc = 0.712323
Validation auc = 0.712323
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.711689
Validation auc = 0.711689
Validation auc = 0.711689
Validation auc = 0.711689
Model 0 best validation auc = 0.742401 on epoch 13
Model 0 best validation auc = 0.742401 on epoch 13
Model 0 best validation auc = 0.742401 on epoch 13
Model 0 best validation auc = 0.742401 on epoch 13
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.740544
Model 0 test auc = 0.740544
Model 0 test auc = 0.740544
Model 0 test auc = 0.740544
Ensemble metrics: AUC=0.740544, Accuracy=0.623596, Precision=0.638298, Recall=0.645161, F1=0.641711
Ensemble metrics: AUC=0.740544, Accuracy=0.623596, Precision=0.638298, Recall=0.645161, F1=0.641711
Ensemble metrics: AUC=0.740544, Accuracy=0.623596, Precision=0.638298, Recall=0.645161, F1=0.641711
Ensemble metrics: AUC=0.740544, Accuracy=0.623596, Precision=0.638298, Recall=0.645161, F1=0.641711
Ensemble test auc = 0.740544
Ensemble test auc = 0.740544
Ensemble test auc = 0.740544
Ensemble test auc = 0.740544
Fold 1
Fold 1
Fold 1
Fold 1
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 301
Splitting data with seed 301
Splitting data with seed 301
Splitting data with seed 301
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.682616
Validation auc = 0.682616
Validation auc = 0.682616
Validation auc = 0.682616
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.706981
Validation auc = 0.706981
Validation auc = 0.706981
Validation auc = 0.706981
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.718217
Validation auc = 0.718217
Validation auc = 0.718217
Validation auc = 0.718217
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.722384
Validation auc = 0.722384
Validation auc = 0.722384
Validation auc = 0.722384
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.702437
Validation auc = 0.702437
Validation auc = 0.702437
Validation auc = 0.702437
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.714430
Validation auc = 0.714430
Validation auc = 0.714430
Validation auc = 0.714430
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.717839
Validation auc = 0.717839
Validation auc = 0.717839
Validation auc = 0.717839
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.682111
Validation auc = 0.682111
Validation auc = 0.682111
Validation auc = 0.682111
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.687792
Validation auc = 0.687792
Validation auc = 0.687792
Validation auc = 0.687792
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.706981
Validation auc = 0.706981
Validation auc = 0.706981
Validation auc = 0.706981
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.711274
Validation auc = 0.711274
Validation auc = 0.711274
Validation auc = 0.711274
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.677440
Validation auc = 0.677440
Validation auc = 0.677440
Validation auc = 0.677440
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.684383
Validation auc = 0.684383
Validation auc = 0.684383
Validation auc = 0.684383
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.688802
Validation auc = 0.688802
Validation auc = 0.688802
Validation auc = 0.688802
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.706981
Validation auc = 0.706981
Validation auc = 0.706981
Validation auc = 0.706981
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.701679
Validation auc = 0.701679
Validation auc = 0.701679
Validation auc = 0.701679
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.677250
Validation auc = 0.677250
Validation auc = 0.677250
Validation auc = 0.677250
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.686908
Validation auc = 0.686908
Validation auc = 0.686908
Validation auc = 0.686908
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.697008
Validation auc = 0.697008
Validation auc = 0.697008
Validation auc = 0.697008
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.683878
Validation auc = 0.683878
Validation auc = 0.683878
Validation auc = 0.683878
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.690696
Validation auc = 0.690696
Validation auc = 0.690696
Validation auc = 0.690696
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.699785
Validation auc = 0.699785
Validation auc = 0.699785
Validation auc = 0.699785
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.683247
Validation auc = 0.683247
Validation auc = 0.683247
Validation auc = 0.683247
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.672074
Validation auc = 0.672074
Validation auc = 0.672074
Validation auc = 0.672074
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.688360
Validation auc = 0.688360
Validation auc = 0.688360
Validation auc = 0.688360
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.690822
Validation auc = 0.690822
Validation auc = 0.690822
Validation auc = 0.690822
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.698902
Validation auc = 0.698902
Validation auc = 0.698902
Validation auc = 0.698902
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.684131
Validation auc = 0.684131
Validation auc = 0.684131
Validation auc = 0.684131
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.681606
Validation auc = 0.681606
Validation auc = 0.681606
Validation auc = 0.681606
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.687224
Validation auc = 0.687224
Validation auc = 0.687224
Validation auc = 0.687224
Model 0 best validation auc = 0.722384 on epoch 3
Model 0 best validation auc = 0.722384 on epoch 3
Model 0 best validation auc = 0.722384 on epoch 3
Model 0 best validation auc = 0.722384 on epoch 3
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.689690
Model 0 test auc = 0.689690
Model 0 test auc = 0.689690
Model 0 test auc = 0.689690
Ensemble metrics: AUC=0.689690, Accuracy=0.617978, Precision=0.671233, Recall=0.526882, F1=0.590361
Ensemble metrics: AUC=0.689690, Accuracy=0.617978, Precision=0.671233, Recall=0.526882, F1=0.590361
Ensemble metrics: AUC=0.689690, Accuracy=0.617978, Precision=0.671233, Recall=0.526882, F1=0.590361
Ensemble metrics: AUC=0.689690, Accuracy=0.617978, Precision=0.671233, Recall=0.526882, F1=0.590361
Ensemble test auc = 0.689690
Ensemble test auc = 0.689690
Ensemble test auc = 0.689690
Ensemble test auc = 0.689690
Fold 2
Fold 2
Fold 2
Fold 2
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 302
Splitting data with seed 302
Splitting data with seed 302
Splitting data with seed 302
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.615881
Validation auc = 0.615881
Validation auc = 0.615881
Validation auc = 0.615881
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.627913
Validation auc = 0.627913
Validation auc = 0.627913
Validation auc = 0.627913
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.697568
Validation auc = 0.697568
Validation auc = 0.697568
Validation auc = 0.697568
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.613095
Validation auc = 0.613095
Validation auc = 0.613095
Validation auc = 0.613095
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.717832
Validation auc = 0.717832
Validation auc = 0.717832
Validation auc = 0.717832
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.685284
Validation auc = 0.685284
Validation auc = 0.685284
Validation auc = 0.685284
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.732523
Validation auc = 0.732523
Validation auc = 0.732523
Validation auc = 0.732523
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.703774
Validation auc = 0.703774
Validation auc = 0.703774
Validation auc = 0.703774
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.747214
Validation auc = 0.747214
Validation auc = 0.747214
Validation auc = 0.747214
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.725177
Validation auc = 0.725177
Validation auc = 0.725177
Validation auc = 0.725177
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.712893
Validation auc = 0.712893
Validation auc = 0.712893
Validation auc = 0.712893
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.707953
Validation auc = 0.707953
Validation auc = 0.707953
Validation auc = 0.707953
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.709853
Validation auc = 0.709853
Validation auc = 0.709853
Validation auc = 0.709853
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.692123
Validation auc = 0.692123
Validation auc = 0.692123
Validation auc = 0.692123
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.720618
Validation auc = 0.720618
Validation auc = 0.720618
Validation auc = 0.720618
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.703521
Validation auc = 0.703521
Validation auc = 0.703521
Validation auc = 0.703521
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.704154
Validation auc = 0.704154
Validation auc = 0.704154
Validation auc = 0.704154
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.703457
Validation auc = 0.703457
Validation auc = 0.703457
Validation auc = 0.703457
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.692376
Validation auc = 0.692376
Validation auc = 0.692376
Validation auc = 0.692376
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.702001
Validation auc = 0.702001
Validation auc = 0.702001
Validation auc = 0.702001
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.706940
Validation auc = 0.706940
Validation auc = 0.706940
Validation auc = 0.706940
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.710676
Validation auc = 0.710676
Validation auc = 0.710676
Validation auc = 0.710676
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.714982
Validation auc = 0.714982
Validation auc = 0.714982
Validation auc = 0.714982
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.696302
Validation auc = 0.696302
Validation auc = 0.696302
Validation auc = 0.696302
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.701114
Validation auc = 0.701114
Validation auc = 0.701114
Validation auc = 0.701114
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.704787
Validation auc = 0.704787
Validation auc = 0.704787
Validation auc = 0.704787
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.704344
Validation auc = 0.704344
Validation auc = 0.704344
Validation auc = 0.704344
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.709916
Validation auc = 0.709916
Validation auc = 0.709916
Validation auc = 0.709916
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.710930
Validation auc = 0.710930
Validation auc = 0.710930
Validation auc = 0.710930
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.670719
Validation auc = 0.670719
Validation auc = 0.670719
Validation auc = 0.670719
Model 0 best validation auc = 0.747214 on epoch 8
Model 0 best validation auc = 0.747214 on epoch 8
Model 0 best validation auc = 0.747214 on epoch 8
Model 0 best validation auc = 0.747214 on epoch 8
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.740266
Model 0 test auc = 0.740266
Model 0 test auc = 0.740266
Model 0 test auc = 0.740266
Ensemble metrics: AUC=0.740266, Accuracy=0.662921, Precision=0.633588, Recall=0.873684, F1=0.734513
Ensemble metrics: AUC=0.740266, Accuracy=0.662921, Precision=0.633588, Recall=0.873684, F1=0.734513
Ensemble metrics: AUC=0.740266, Accuracy=0.662921, Precision=0.633588, Recall=0.873684, F1=0.734513
Ensemble metrics: AUC=0.740266, Accuracy=0.662921, Precision=0.633588, Recall=0.873684, F1=0.734513
Ensemble test auc = 0.740266
Ensemble test auc = 0.740266
Ensemble test auc = 0.740266
Ensemble test auc = 0.740266
Fold 3
Fold 3
Fold 3
Fold 3
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 303
Splitting data with seed 303
Splitting data with seed 303
Splitting data with seed 303
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.697008
Validation auc = 0.697008
Validation auc = 0.697008
Validation auc = 0.697008
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.693221
Validation auc = 0.693221
Validation auc = 0.693221
Validation auc = 0.693221
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.694736
Validation auc = 0.694736
Validation auc = 0.694736
Validation auc = 0.694736
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.728065
Validation auc = 0.728065
Validation auc = 0.728065
Validation auc = 0.728065
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.704709
Validation auc = 0.704709
Validation auc = 0.704709
Validation auc = 0.704709
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.728065
Validation auc = 0.728065
Validation auc = 0.728065
Validation auc = 0.728065
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.763161
Validation auc = 0.763161
Validation auc = 0.763161
Validation auc = 0.763161
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.760510
Validation auc = 0.760510
Validation auc = 0.760510
Validation auc = 0.760510
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.725035
Validation auc = 0.725035
Validation auc = 0.725035
Validation auc = 0.725035
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.745613
Validation auc = 0.745613
Validation auc = 0.745613
Validation auc = 0.745613
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.788916
Validation auc = 0.788916
Validation auc = 0.788916
Validation auc = 0.788916
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.751168
Validation auc = 0.751168
Validation auc = 0.751168
Validation auc = 0.751168
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.774018
Validation auc = 0.774018
Validation auc = 0.774018
Validation auc = 0.774018
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.771872
Validation auc = 0.771872
Validation auc = 0.771872
Validation auc = 0.771872
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.800530
Validation auc = 0.800530
Validation auc = 0.800530
Validation auc = 0.800530
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.794849
Validation auc = 0.794849
Validation auc = 0.794849
Validation auc = 0.794849
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.789547
Validation auc = 0.789547
Validation auc = 0.789547
Validation auc = 0.789547
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.801035
Validation auc = 0.801035
Validation auc = 0.801035
Validation auc = 0.801035
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.793587
Validation auc = 0.793587
Validation auc = 0.793587
Validation auc = 0.793587
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.777301
Validation auc = 0.777301
Validation auc = 0.777301
Validation auc = 0.777301
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.783613
Validation auc = 0.783613
Validation auc = 0.783613
Validation auc = 0.783613
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.799899
Validation auc = 0.799899
Validation auc = 0.799899
Validation auc = 0.799899
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.778942
Validation auc = 0.778942
Validation auc = 0.778942
Validation auc = 0.778942
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.776038
Validation auc = 0.776038
Validation auc = 0.776038
Validation auc = 0.776038
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.779826
Validation auc = 0.779826
Validation auc = 0.779826
Validation auc = 0.779826
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.783739
Validation auc = 0.783739
Validation auc = 0.783739
Validation auc = 0.783739
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.776102
Validation auc = 0.776102
Validation auc = 0.776102
Validation auc = 0.776102
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.769032
Validation auc = 0.769032
Validation auc = 0.769032
Validation auc = 0.769032
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.764929
Validation auc = 0.764929
Validation auc = 0.764929
Validation auc = 0.764929
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.762467
Validation auc = 0.762467
Validation auc = 0.762467
Validation auc = 0.762467
Model 0 best validation auc = 0.801035 on epoch 17
Model 0 best validation auc = 0.801035 on epoch 17
Model 0 best validation auc = 0.801035 on epoch 17
Model 0 best validation auc = 0.801035 on epoch 17
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.757472
Model 0 test auc = 0.757472
Model 0 test auc = 0.757472
Model 0 test auc = 0.757472
Ensemble metrics: AUC=0.757472, Accuracy=0.657303, Precision=0.703704, Recall=0.606383, F1=0.651429
Ensemble metrics: AUC=0.757472, Accuracy=0.657303, Precision=0.703704, Recall=0.606383, F1=0.651429
Ensemble metrics: AUC=0.757472, Accuracy=0.657303, Precision=0.703704, Recall=0.606383, F1=0.651429
Ensemble metrics: AUC=0.757472, Accuracy=0.657303, Precision=0.703704, Recall=0.606383, F1=0.651429
Ensemble test auc = 0.757472
Ensemble test auc = 0.757472
Ensemble test auc = 0.757472
Ensemble test auc = 0.757472
Fold 4
Fold 4
Fold 4
Fold 4
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 304
Splitting data with seed 304
Splitting data with seed 304
Splitting data with seed 304
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.562247
Validation auc = 0.562247
Validation auc = 0.562247
Validation auc = 0.562247
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.559091
Validation auc = 0.559091
Validation auc = 0.559091
Validation auc = 0.559091
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.581818
Validation auc = 0.581818
Validation auc = 0.581818
Validation auc = 0.581818
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.584848
Validation auc = 0.584848
Validation auc = 0.584848
Validation auc = 0.584848
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.604167
Validation auc = 0.604167
Validation auc = 0.604167
Validation auc = 0.604167
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.609596
Validation auc = 0.609596
Validation auc = 0.609596
Validation auc = 0.609596
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.608081
Validation auc = 0.608081
Validation auc = 0.608081
Validation auc = 0.608081
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.601136
Validation auc = 0.601136
Validation auc = 0.601136
Validation auc = 0.601136
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.608586
Validation auc = 0.608586
Validation auc = 0.608586
Validation auc = 0.608586
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.617551
Validation auc = 0.617551
Validation auc = 0.617551
Validation auc = 0.617551
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.624747
Validation auc = 0.624747
Validation auc = 0.624747
Validation auc = 0.624747
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.629040
Validation auc = 0.629040
Validation auc = 0.629040
Validation auc = 0.629040
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.648737
Validation auc = 0.648737
Validation auc = 0.648737
Validation auc = 0.648737
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.641919
Validation auc = 0.641919
Validation auc = 0.641919
Validation auc = 0.641919
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.635227
Validation auc = 0.635227
Validation auc = 0.635227
Validation auc = 0.635227
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.658081
Validation auc = 0.658081
Validation auc = 0.658081
Validation auc = 0.658081
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.655429
Validation auc = 0.655429
Validation auc = 0.655429
Validation auc = 0.655429
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.631061
Validation auc = 0.631061
Validation auc = 0.631061
Validation auc = 0.631061
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.650379
Validation auc = 0.650379
Validation auc = 0.650379
Validation auc = 0.650379
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.647222
Validation auc = 0.647222
Validation auc = 0.647222
Validation auc = 0.647222
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.643561
Validation auc = 0.643561
Validation auc = 0.643561
Validation auc = 0.643561
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.623548
Validation auc = 0.623548
Validation auc = 0.623548
Validation auc = 0.623548
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.643876
Validation auc = 0.643876
Validation auc = 0.643876
Validation auc = 0.643876
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.651452
Validation auc = 0.651452
Validation auc = 0.651452
Validation auc = 0.651452
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.628725
Validation auc = 0.628725
Validation auc = 0.628725
Validation auc = 0.628725
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.633144
Validation auc = 0.633144
Validation auc = 0.633144
Validation auc = 0.633144
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.640025
Validation auc = 0.640025
Validation auc = 0.640025
Validation auc = 0.640025
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.636364
Validation auc = 0.636364
Validation auc = 0.636364
Validation auc = 0.636364
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.634912
Validation auc = 0.634912
Validation auc = 0.634912
Validation auc = 0.634912
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.633902
Validation auc = 0.633902
Validation auc = 0.633902
Validation auc = 0.633902
Model 0 best validation auc = 0.658081 on epoch 15
Model 0 best validation auc = 0.658081 on epoch 15
Model 0 best validation auc = 0.658081 on epoch 15
Model 0 best validation auc = 0.658081 on epoch 15
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.743255
Model 0 test auc = 0.743255
Model 0 test auc = 0.743255
Model 0 test auc = 0.743255
Ensemble metrics: AUC=0.743255, Accuracy=0.702247, Precision=0.662500, Recall=0.670886, F1=0.666667
Ensemble metrics: AUC=0.743255, Accuracy=0.702247, Precision=0.662500, Recall=0.670886, F1=0.666667
Ensemble metrics: AUC=0.743255, Accuracy=0.702247, Precision=0.662500, Recall=0.670886, F1=0.666667
Ensemble metrics: AUC=0.743255, Accuracy=0.702247, Precision=0.662500, Recall=0.670886, F1=0.666667
Ensemble test auc = 0.743255
Ensemble test auc = 0.743255
Ensemble test auc = 0.743255
Ensemble test auc = 0.743255
5-fold cross validation
5-fold cross validation
5-fold cross validation
5-fold cross validation
Seed 300 ==> test auc = 0.740544
Seed 300 ==> test auc = 0.740544
Seed 300 ==> test auc = 0.740544
Seed 300 ==> test auc = 0.740544
Seed 301 ==> test auc = 0.689690
Seed 301 ==> test auc = 0.689690
Seed 301 ==> test auc = 0.689690
Seed 301 ==> test auc = 0.689690
Seed 302 ==> test auc = 0.740266
Seed 302 ==> test auc = 0.740266
Seed 302 ==> test auc = 0.740266
Seed 302 ==> test auc = 0.740266
Seed 303 ==> test auc = 0.757472
Seed 303 ==> test auc = 0.757472
Seed 303 ==> test auc = 0.757472
Seed 303 ==> test auc = 0.757472
Seed 304 ==> test auc = 0.743255
Seed 304 ==> test auc = 0.743255
Seed 304 ==> test auc = 0.743255
Seed 304 ==> test auc = 0.743255
Overall test auc = 0.734246 +/- 0.023159
Overall test auc = 0.734246 +/- 0.023159
Overall test auc = 0.734246 +/- 0.023159
Overall test auc = 0.734246 +/- 0.023159
Fold 0
Fold 0
Fold 0
Fold 0
Fold 0
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 400
Splitting data with seed 400
Splitting data with seed 400
Splitting data with seed 400
Splitting data with seed 400
Class sizes
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.572296
Validation auc = 0.572296
Validation auc = 0.572296
Validation auc = 0.572296
Validation auc = 0.572296
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.658950
Validation auc = 0.658950
Validation auc = 0.658950
Validation auc = 0.658950
Validation auc = 0.658950
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.666287
Validation auc = 0.666287
Validation auc = 0.666287
Validation auc = 0.666287
Validation auc = 0.666287
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.698292
Validation auc = 0.698292
Validation auc = 0.698292
Validation auc = 0.698292
Validation auc = 0.698292
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.703352
Validation auc = 0.703352
Validation auc = 0.703352
Validation auc = 0.703352
Validation auc = 0.703352
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.697913
Validation auc = 0.697913
Validation auc = 0.697913
Validation auc = 0.697913
Validation auc = 0.697913
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.701961
Validation auc = 0.701961
Validation auc = 0.701961
Validation auc = 0.701961
Validation auc = 0.701961
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.690070
Validation auc = 0.690070
Validation auc = 0.690070
Validation auc = 0.690070
Validation auc = 0.690070
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.692473
Validation auc = 0.692473
Validation auc = 0.692473
Validation auc = 0.692473
Validation auc = 0.692473
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.728147
Validation auc = 0.728147
Validation auc = 0.728147
Validation auc = 0.728147
Validation auc = 0.728147
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.680455
Validation auc = 0.680455
Validation auc = 0.680455
Validation auc = 0.680455
Validation auc = 0.680455
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.722707
Validation auc = 0.722707
Validation auc = 0.722707
Validation auc = 0.722707
Validation auc = 0.722707
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.726945
Validation auc = 0.726945
Validation auc = 0.726945
Validation auc = 0.726945
Validation auc = 0.726945
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.713852
Validation auc = 0.713852
Validation auc = 0.713852
Validation auc = 0.713852
Validation auc = 0.713852
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.694560
Validation auc = 0.694560
Validation auc = 0.694560
Validation auc = 0.694560
Validation auc = 0.694560
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.708349
Validation auc = 0.708349
Validation auc = 0.708349
Validation auc = 0.708349
Validation auc = 0.708349
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.711638
Validation auc = 0.711638
Validation auc = 0.711638
Validation auc = 0.711638
Validation auc = 0.711638
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.685705
Validation auc = 0.685705
Validation auc = 0.685705
Validation auc = 0.685705
Validation auc = 0.685705
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.720177
Validation auc = 0.720177
Validation auc = 0.720177
Validation auc = 0.720177
Validation auc = 0.720177
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.715686
Validation auc = 0.715686
Validation auc = 0.715686
Validation auc = 0.715686
Validation auc = 0.715686
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.718912
Validation auc = 0.718912
Validation auc = 0.718912
Validation auc = 0.718912
Validation auc = 0.718912
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.702467
Validation auc = 0.702467
Validation auc = 0.702467
Validation auc = 0.702467
Validation auc = 0.702467
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.729222
Validation auc = 0.729222
Validation auc = 0.729222
Validation auc = 0.729222
Validation auc = 0.729222
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.740923
Validation auc = 0.740923
Validation auc = 0.740923
Validation auc = 0.740923
Validation auc = 0.740923
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.731689
Validation auc = 0.731689
Validation auc = 0.731689
Validation auc = 0.731689
Validation auc = 0.731689
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.719545
Validation auc = 0.719545
Validation auc = 0.719545
Validation auc = 0.719545
Validation auc = 0.719545
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.718090
Validation auc = 0.718090
Validation auc = 0.718090
Validation auc = 0.718090
Validation auc = 0.718090
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.718153
Validation auc = 0.718153
Validation auc = 0.718153
Validation auc = 0.718153
Validation auc = 0.718153
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.709298
Validation auc = 0.709298
Validation auc = 0.709298
Validation auc = 0.709298
Validation auc = 0.709298
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.692789
Validation auc = 0.692789
Validation auc = 0.692789
Validation auc = 0.692789
Validation auc = 0.692789
Model 0 best validation auc = 0.740923 on epoch 23
Model 0 best validation auc = 0.740923 on epoch 23
Model 0 best validation auc = 0.740923 on epoch 23
Model 0 best validation auc = 0.740923 on epoch 23
Model 0 best validation auc = 0.740923 on epoch 23
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.751680
Model 0 test auc = 0.751680
Model 0 test auc = 0.751680
Model 0 test auc = 0.751680
Model 0 test auc = 0.751680
Ensemble metrics: AUC=0.751680, Accuracy=0.679775, Precision=0.672727, Recall=0.778947, F1=0.721951
Ensemble metrics: AUC=0.751680, Accuracy=0.679775, Precision=0.672727, Recall=0.778947, F1=0.721951
Ensemble metrics: AUC=0.751680, Accuracy=0.679775, Precision=0.672727, Recall=0.778947, F1=0.721951
Ensemble metrics: AUC=0.751680, Accuracy=0.679775, Precision=0.672727, Recall=0.778947, F1=0.721951
Ensemble metrics: AUC=0.751680, Accuracy=0.679775, Precision=0.672727, Recall=0.778947, F1=0.721951
Ensemble test auc = 0.751680
Ensemble test auc = 0.751680
Ensemble test auc = 0.751680
Ensemble test auc = 0.751680
Ensemble test auc = 0.751680
Fold 1
Fold 1
Fold 1
Fold 1
Fold 1
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 401
Splitting data with seed 401
Splitting data with seed 401
Splitting data with seed 401
Splitting data with seed 401
Class sizes
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.606199
Validation auc = 0.606199
Validation auc = 0.606199
Validation auc = 0.606199
Validation auc = 0.606199
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.680582
Validation auc = 0.680582
Validation auc = 0.680582
Validation auc = 0.680582
Validation auc = 0.680582
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.676407
Validation auc = 0.676407
Validation auc = 0.676407
Validation auc = 0.676407
Validation auc = 0.676407
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.718533
Validation auc = 0.718533
Validation auc = 0.718533
Validation auc = 0.718533
Validation auc = 0.718533
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.692726
Validation auc = 0.692726
Validation auc = 0.692726
Validation auc = 0.692726
Validation auc = 0.692726
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.736749
Validation auc = 0.736749
Validation auc = 0.736749
Validation auc = 0.736749
Validation auc = 0.736749
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.727008
Validation auc = 0.727008
Validation auc = 0.727008
Validation auc = 0.727008
Validation auc = 0.727008
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.740417
Validation auc = 0.740417
Validation auc = 0.740417
Validation auc = 0.740417
Validation auc = 0.740417
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.758381
Validation auc = 0.758381
Validation auc = 0.758381
Validation auc = 0.758381
Validation auc = 0.758381
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.756104
Validation auc = 0.756104
Validation auc = 0.756104
Validation auc = 0.756104
Validation auc = 0.756104
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.740797
Validation auc = 0.740797
Validation auc = 0.740797
Validation auc = 0.740797
Validation auc = 0.740797
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.738646
Validation auc = 0.738646
Validation auc = 0.738646
Validation auc = 0.738646
Validation auc = 0.738646
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.686022
Validation auc = 0.686022
Validation auc = 0.686022
Validation auc = 0.686022
Validation auc = 0.686022
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.768627
Validation auc = 0.768627
Validation auc = 0.768627
Validation auc = 0.768627
Validation auc = 0.768627
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.741429
Validation auc = 0.741429
Validation auc = 0.741429
Validation auc = 0.741429
Validation auc = 0.741429
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.729791
Validation auc = 0.729791
Validation auc = 0.729791
Validation auc = 0.729791
Validation auc = 0.729791
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.753574
Validation auc = 0.753574
Validation auc = 0.753574
Validation auc = 0.753574
Validation auc = 0.753574
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.734092
Validation auc = 0.734092
Validation auc = 0.734092
Validation auc = 0.734092
Validation auc = 0.734092
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.752182
Validation auc = 0.752182
Validation auc = 0.752182
Validation auc = 0.752182
Validation auc = 0.752182
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.748008
Validation auc = 0.748008
Validation auc = 0.748008
Validation auc = 0.748008
Validation auc = 0.748008
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.756420
Validation auc = 0.756420
Validation auc = 0.756420
Validation auc = 0.756420
Validation auc = 0.756420
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.717268
Validation auc = 0.717268
Validation auc = 0.717268
Validation auc = 0.717268
Validation auc = 0.717268
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.734535
Validation auc = 0.734535
Validation auc = 0.734535
Validation auc = 0.734535
Validation auc = 0.734535
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.732954
Validation auc = 0.732954
Validation auc = 0.732954
Validation auc = 0.732954
Validation auc = 0.732954
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.721758
Validation auc = 0.721758
Validation auc = 0.721758
Validation auc = 0.721758
Validation auc = 0.721758
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.727071
Validation auc = 0.727071
Validation auc = 0.727071
Validation auc = 0.727071
Validation auc = 0.727071
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.735547
Validation auc = 0.735547
Validation auc = 0.735547
Validation auc = 0.735547
Validation auc = 0.735547
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.730424
Validation auc = 0.730424
Validation auc = 0.730424
Validation auc = 0.730424
Validation auc = 0.730424
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.725933
Validation auc = 0.725933
Validation auc = 0.725933
Validation auc = 0.725933
Validation auc = 0.725933
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.732827
Validation auc = 0.732827
Validation auc = 0.732827
Validation auc = 0.732827
Validation auc = 0.732827
Model 0 best validation auc = 0.768627 on epoch 13
Model 0 best validation auc = 0.768627 on epoch 13
Model 0 best validation auc = 0.768627 on epoch 13
Model 0 best validation auc = 0.768627 on epoch 13
Model 0 best validation auc = 0.768627 on epoch 13
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.738005
Model 0 test auc = 0.738005
Model 0 test auc = 0.738005
Model 0 test auc = 0.738005
Model 0 test auc = 0.738005
Ensemble metrics: AUC=0.738005, Accuracy=0.640449, Precision=0.653846, Recall=0.579545, F1=0.614458
Ensemble metrics: AUC=0.738005, Accuracy=0.640449, Precision=0.653846, Recall=0.579545, F1=0.614458
Ensemble metrics: AUC=0.738005, Accuracy=0.640449, Precision=0.653846, Recall=0.579545, F1=0.614458
Ensemble metrics: AUC=0.738005, Accuracy=0.640449, Precision=0.653846, Recall=0.579545, F1=0.614458
Ensemble metrics: AUC=0.738005, Accuracy=0.640449, Precision=0.653846, Recall=0.579545, F1=0.614458
Ensemble test auc = 0.738005
Ensemble test auc = 0.738005
Ensemble test auc = 0.738005
Ensemble test auc = 0.738005
Ensemble test auc = 0.738005
Fold 2
Fold 2
Fold 2
Fold 2
Fold 2
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 402
Splitting data with seed 402
Splitting data with seed 402
Splitting data with seed 402
Splitting data with seed 402
Class sizes
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.629615
Validation auc = 0.629615
Validation auc = 0.629615
Validation auc = 0.629615
Validation auc = 0.629615
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.633590
Validation auc = 0.633590
Validation auc = 0.633590
Validation auc = 0.633590
Validation auc = 0.633590
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.638846
Validation auc = 0.638846
Validation auc = 0.638846
Validation auc = 0.638846
Validation auc = 0.638846
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.647821
Validation auc = 0.647821
Validation auc = 0.647821
Validation auc = 0.647821
Validation auc = 0.647821
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.670641
Validation auc = 0.670641
Validation auc = 0.670641
Validation auc = 0.670641
Validation auc = 0.670641
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.668718
Validation auc = 0.668718
Validation auc = 0.668718
Validation auc = 0.668718
Validation auc = 0.668718
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.679744
Validation auc = 0.679744
Validation auc = 0.679744
Validation auc = 0.679744
Validation auc = 0.679744
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.685256
Validation auc = 0.685256
Validation auc = 0.685256
Validation auc = 0.685256
Validation auc = 0.685256
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.700769
Validation auc = 0.700769
Validation auc = 0.700769
Validation auc = 0.700769
Validation auc = 0.700769
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.714487
Validation auc = 0.714487
Validation auc = 0.714487
Validation auc = 0.714487
Validation auc = 0.714487
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.718462
Validation auc = 0.718462
Validation auc = 0.718462
Validation auc = 0.718462
Validation auc = 0.718462
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.711923
Validation auc = 0.711923
Validation auc = 0.711923
Validation auc = 0.711923
Validation auc = 0.711923
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.738077
Validation auc = 0.738077
Validation auc = 0.738077
Validation auc = 0.738077
Validation auc = 0.738077
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.730769
Validation auc = 0.730769
Validation auc = 0.730769
Validation auc = 0.730769
Validation auc = 0.730769
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.739744
Validation auc = 0.739744
Validation auc = 0.739744
Validation auc = 0.739744
Validation auc = 0.739744
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.728462
Validation auc = 0.728462
Validation auc = 0.728462
Validation auc = 0.728462
Validation auc = 0.728462
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.727821
Validation auc = 0.727821
Validation auc = 0.727821
Validation auc = 0.727821
Validation auc = 0.727821
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.733590
Validation auc = 0.733590
Validation auc = 0.733590
Validation auc = 0.733590
Validation auc = 0.733590
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.732051
Validation auc = 0.732051
Validation auc = 0.732051
Validation auc = 0.732051
Validation auc = 0.732051
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.745962
Validation auc = 0.745962
Validation auc = 0.745962
Validation auc = 0.745962
Validation auc = 0.745962
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.752564
Validation auc = 0.752564
Validation auc = 0.752564
Validation auc = 0.752564
Validation auc = 0.752564
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.739231
Validation auc = 0.739231
Validation auc = 0.739231
Validation auc = 0.739231
Validation auc = 0.739231
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.739103
Validation auc = 0.739103
Validation auc = 0.739103
Validation auc = 0.739103
Validation auc = 0.739103
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Validation auc = 0.740256
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.737564
Validation auc = 0.737564
Validation auc = 0.737564
Validation auc = 0.737564
Validation auc = 0.737564
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.741987
Validation auc = 0.741987
Validation auc = 0.741987
Validation auc = 0.741987
Validation auc = 0.741987
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.745705
Validation auc = 0.745705
Validation auc = 0.745705
Validation auc = 0.745705
Validation auc = 0.745705
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.745705
Validation auc = 0.745705
Validation auc = 0.745705
Validation auc = 0.745705
Validation auc = 0.745705
Model 0 best validation auc = 0.752564 on epoch 20
Model 0 best validation auc = 0.752564 on epoch 20
Model 0 best validation auc = 0.752564 on epoch 20
Model 0 best validation auc = 0.752564 on epoch 20
Model 0 best validation auc = 0.752564 on epoch 20
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.733730
Model 0 test auc = 0.733730
Model 0 test auc = 0.733730
Model 0 test auc = 0.733730
Model 0 test auc = 0.733730
Ensemble metrics: AUC=0.733730, Accuracy=0.640449, Precision=0.647059, Recall=0.777778, F1=0.706422
Ensemble metrics: AUC=0.733730, Accuracy=0.640449, Precision=0.647059, Recall=0.777778, F1=0.706422
Ensemble metrics: AUC=0.733730, Accuracy=0.640449, Precision=0.647059, Recall=0.777778, F1=0.706422
Ensemble metrics: AUC=0.733730, Accuracy=0.640449, Precision=0.647059, Recall=0.777778, F1=0.706422
Ensemble metrics: AUC=0.733730, Accuracy=0.640449, Precision=0.647059, Recall=0.777778, F1=0.706422
Ensemble test auc = 0.733730
Ensemble test auc = 0.733730
Ensemble test auc = 0.733730
Ensemble test auc = 0.733730
Ensemble test auc = 0.733730
Fold 3
Fold 3
Fold 3
Fold 3
Fold 3
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 403
Splitting data with seed 403
Splitting data with seed 403
Splitting data with seed 403
Splitting data with seed 403
Class sizes
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.652091
Validation auc = 0.652091
Validation auc = 0.652091
Validation auc = 0.652091
Validation auc = 0.652091
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.696458
Validation auc = 0.696458
Validation auc = 0.696458
Validation auc = 0.696458
Validation auc = 0.696458
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.683289
Validation auc = 0.683289
Validation auc = 0.683289
Validation auc = 0.683289
Validation auc = 0.683289
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.679836
Validation auc = 0.679836
Validation auc = 0.679836
Validation auc = 0.679836
Validation auc = 0.679836
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.678941
Validation auc = 0.678941
Validation auc = 0.678941
Validation auc = 0.678941
Validation auc = 0.678941
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.691600
Validation auc = 0.691600
Validation auc = 0.691600
Validation auc = 0.691600
Validation auc = 0.691600
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.651451
Validation auc = 0.651451
Validation auc = 0.651451
Validation auc = 0.651451
Validation auc = 0.651451
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.704513
Validation auc = 0.704513
Validation auc = 0.704513
Validation auc = 0.704513
Validation auc = 0.704513
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.752078
Validation auc = 0.752078
Validation auc = 0.752078
Validation auc = 0.752078
Validation auc = 0.752078
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.705281
Validation auc = 0.705281
Validation auc = 0.705281
Validation auc = 0.705281
Validation auc = 0.705281
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.734561
Validation auc = 0.734561
Validation auc = 0.734561
Validation auc = 0.734561
Validation auc = 0.734561
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.758343
Validation auc = 0.758343
Validation auc = 0.758343
Validation auc = 0.758343
Validation auc = 0.758343
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.794911
Validation auc = 0.794911
Validation auc = 0.794911
Validation auc = 0.794911
Validation auc = 0.794911
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.784043
Validation auc = 0.784043
Validation auc = 0.784043
Validation auc = 0.784043
Validation auc = 0.784043
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.786984
Validation auc = 0.786984
Validation auc = 0.786984
Validation auc = 0.786984
Validation auc = 0.786984
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.772791
Validation auc = 0.772791
Validation auc = 0.772791
Validation auc = 0.772791
Validation auc = 0.772791
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.782125
Validation auc = 0.782125
Validation auc = 0.782125
Validation auc = 0.782125
Validation auc = 0.782125
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.785194
Validation auc = 0.785194
Validation auc = 0.785194
Validation auc = 0.785194
Validation auc = 0.785194
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.796701
Validation auc = 0.796701
Validation auc = 0.796701
Validation auc = 0.796701
Validation auc = 0.796701
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.810254
Validation auc = 0.810254
Validation auc = 0.810254
Validation auc = 0.810254
Validation auc = 0.810254
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.814346
Validation auc = 0.814346
Validation auc = 0.814346
Validation auc = 0.814346
Validation auc = 0.814346
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.810127
Validation auc = 0.810127
Validation auc = 0.810127
Validation auc = 0.810127
Validation auc = 0.810127
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.812556
Validation auc = 0.812556
Validation auc = 0.812556
Validation auc = 0.812556
Validation auc = 0.812556
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.807186
Validation auc = 0.807186
Validation auc = 0.807186
Validation auc = 0.807186
Validation auc = 0.807186
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.813707
Validation auc = 0.813707
Validation auc = 0.813707
Validation auc = 0.813707
Validation auc = 0.813707
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.804565
Validation auc = 0.804565
Validation auc = 0.804565
Validation auc = 0.804565
Validation auc = 0.804565
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.796254
Validation auc = 0.796254
Validation auc = 0.796254
Validation auc = 0.796254
Validation auc = 0.796254
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.798427
Validation auc = 0.798427
Validation auc = 0.798427
Validation auc = 0.798427
Validation auc = 0.798427
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.798363
Validation auc = 0.798363
Validation auc = 0.798363
Validation auc = 0.798363
Validation auc = 0.798363
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.799194
Validation auc = 0.799194
Validation auc = 0.799194
Validation auc = 0.799194
Validation auc = 0.799194
Model 0 best validation auc = 0.814346 on epoch 20
Model 0 best validation auc = 0.814346 on epoch 20
Model 0 best validation auc = 0.814346 on epoch 20
Model 0 best validation auc = 0.814346 on epoch 20
Model 0 best validation auc = 0.814346 on epoch 20
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.748642
Model 0 test auc = 0.748642
Model 0 test auc = 0.748642
Model 0 test auc = 0.748642
Model 0 test auc = 0.748642
Ensemble metrics: AUC=0.748642, Accuracy=0.657303, Precision=0.647059, Recall=0.725275, F1=0.683938
Ensemble metrics: AUC=0.748642, Accuracy=0.657303, Precision=0.647059, Recall=0.725275, F1=0.683938
Ensemble metrics: AUC=0.748642, Accuracy=0.657303, Precision=0.647059, Recall=0.725275, F1=0.683938
Ensemble metrics: AUC=0.748642, Accuracy=0.657303, Precision=0.647059, Recall=0.725275, F1=0.683938
Ensemble metrics: AUC=0.748642, Accuracy=0.657303, Precision=0.647059, Recall=0.725275, F1=0.683938
Ensemble test auc = 0.748642
Ensemble test auc = 0.748642
Ensemble test auc = 0.748642
Ensemble test auc = 0.748642
Ensemble test auc = 0.748642
Fold 4
Fold 4
Fold 4
Fold 4
Fold 4
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Using device: cuda
Loading data
Loading data
Loading data
Loading data
Loading data
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Number of tasks = 1
Splitting data with seed 404
Splitting data with seed 404
Splitting data with seed 404
Splitting data with seed 404
Splitting data with seed 404
Class sizes
Class sizes
Class sizes
Class sizes
Class sizes
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
p_np 0: 48.93%, 1: 51.07%
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Total size = 1,778 | train size = 1,422 | val size = 178 | test size = 178
Building model 0
Building model 0
Building model 0
Building model 0
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i_atom): Linear(in_features=133, out_features=300, bias=False)
      (W_i_bond): Linear(in_features=147, out_features=300, bias=False)
      (W_h_atom): Linear(in_features=447, out_features=300, bias=False)
      (W_h_0): Linear(in_features=300, out_features=300, bias=False)
      (W_h_1): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=600, out_features=300, bias=True)
      (gru): BatchGRU(
        (gru): GRU(300, 300, batch_first=True, bidirectional=True)
      )
      (lr): Linear(in_features=900, out_features=300, bias=False)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Number of parameters = 2,022,901
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Epoch 0
Validation auc = 0.587372
Validation auc = 0.587372
Validation auc = 0.587372
Validation auc = 0.587372
Validation auc = 0.587372
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Epoch 1
Validation auc = 0.642347
Validation auc = 0.642347
Validation auc = 0.642347
Validation auc = 0.642347
Validation auc = 0.642347
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Epoch 2
Validation auc = 0.672194
Validation auc = 0.672194
Validation auc = 0.672194
Validation auc = 0.672194
Validation auc = 0.672194
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Epoch 3
Validation auc = 0.675000
Validation auc = 0.675000
Validation auc = 0.675000
Validation auc = 0.675000
Validation auc = 0.675000
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Epoch 4
Validation auc = 0.669515
Validation auc = 0.669515
Validation auc = 0.669515
Validation auc = 0.669515
Validation auc = 0.669515
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Epoch 5
Validation auc = 0.674362
Validation auc = 0.674362
Validation auc = 0.674362
Validation auc = 0.674362
Validation auc = 0.674362
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Epoch 6
Validation auc = 0.697577
Validation auc = 0.697577
Validation auc = 0.697577
Validation auc = 0.697577
Validation auc = 0.697577
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Epoch 7
Validation auc = 0.690306
Validation auc = 0.690306
Validation auc = 0.690306
Validation auc = 0.690306
Validation auc = 0.690306
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Epoch 8
Validation auc = 0.693878
Validation auc = 0.693878
Validation auc = 0.693878
Validation auc = 0.693878
Validation auc = 0.693878
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Epoch 9
Validation auc = 0.688776
Validation auc = 0.688776
Validation auc = 0.688776
Validation auc = 0.688776
Validation auc = 0.688776
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Epoch 10
Validation auc = 0.716327
Validation auc = 0.716327
Validation auc = 0.716327
Validation auc = 0.716327
Validation auc = 0.716327
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Epoch 11
Validation auc = 0.710332
Validation auc = 0.710332
Validation auc = 0.710332
Validation auc = 0.710332
Validation auc = 0.710332
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Epoch 12
Validation auc = 0.713520
Validation auc = 0.713520
Validation auc = 0.713520
Validation auc = 0.713520
Validation auc = 0.713520
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Epoch 13
Validation auc = 0.700765
Validation auc = 0.700765
Validation auc = 0.700765
Validation auc = 0.700765
Validation auc = 0.700765
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Epoch 14
Validation auc = 0.682653
Validation auc = 0.682653
Validation auc = 0.682653
Validation auc = 0.682653
Validation auc = 0.682653
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Epoch 15
Validation auc = 0.706505
Validation auc = 0.706505
Validation auc = 0.706505
Validation auc = 0.706505
Validation auc = 0.706505
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Epoch 16
Validation auc = 0.681378
Validation auc = 0.681378
Validation auc = 0.681378
Validation auc = 0.681378
Validation auc = 0.681378
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Epoch 17
Validation auc = 0.693750
Validation auc = 0.693750
Validation auc = 0.693750
Validation auc = 0.693750
Validation auc = 0.693750
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Epoch 18
Validation auc = 0.700957
Validation auc = 0.700957
Validation auc = 0.700957
Validation auc = 0.700957
Validation auc = 0.700957
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Epoch 19
Validation auc = 0.690689
Validation auc = 0.690689
Validation auc = 0.690689
Validation auc = 0.690689
Validation auc = 0.690689
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Epoch 20
Validation auc = 0.659694
Validation auc = 0.659694
Validation auc = 0.659694
Validation auc = 0.659694
Validation auc = 0.659694
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Epoch 21
Validation auc = 0.701467
Validation auc = 0.701467
Validation auc = 0.701467
Validation auc = 0.701467
Validation auc = 0.701467
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Epoch 22
Validation auc = 0.680485
Validation auc = 0.680485
Validation auc = 0.680485
Validation auc = 0.680485
Validation auc = 0.680485
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Epoch 23
Validation auc = 0.678061
Validation auc = 0.678061
Validation auc = 0.678061
Validation auc = 0.678061
Validation auc = 0.678061
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Epoch 24
Validation auc = 0.691582
Validation auc = 0.691582
Validation auc = 0.691582
Validation auc = 0.691582
Validation auc = 0.691582
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Epoch 25
Validation auc = 0.680230
Validation auc = 0.680230
Validation auc = 0.680230
Validation auc = 0.680230
Validation auc = 0.680230
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Epoch 26
Validation auc = 0.680804
Validation auc = 0.680804
Validation auc = 0.680804
Validation auc = 0.680804
Validation auc = 0.680804
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Epoch 27
Validation auc = 0.675128
Validation auc = 0.675128
Validation auc = 0.675128
Validation auc = 0.675128
Validation auc = 0.675128
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Epoch 28
Validation auc = 0.669133
Validation auc = 0.669133
Validation auc = 0.669133
Validation auc = 0.669133
Validation auc = 0.669133
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Epoch 29
Validation auc = 0.677806
Validation auc = 0.677806
Validation auc = 0.677806
Validation auc = 0.677806
Validation auc = 0.677806
Model 0 best validation auc = 0.716327 on epoch 10
Model 0 best validation auc = 0.716327 on epoch 10
Model 0 best validation auc = 0.716327 on epoch 10
Model 0 best validation auc = 0.716327 on epoch 10
Model 0 best validation auc = 0.716327 on epoch 10
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Moving model to cuda
Model 0 test auc = 0.670202
Model 0 test auc = 0.670202
Model 0 test auc = 0.670202
Model 0 test auc = 0.670202
Model 0 test auc = 0.670202
Ensemble metrics: AUC=0.670202, Accuracy=0.584270, Precision=0.617647, Recall=0.466667, F1=0.531646
Ensemble metrics: AUC=0.670202, Accuracy=0.584270, Precision=0.617647, Recall=0.466667, F1=0.531646
Ensemble metrics: AUC=0.670202, Accuracy=0.584270, Precision=0.617647, Recall=0.466667, F1=0.531646
Ensemble metrics: AUC=0.670202, Accuracy=0.584270, Precision=0.617647, Recall=0.466667, F1=0.531646
Ensemble metrics: AUC=0.670202, Accuracy=0.584270, Precision=0.617647, Recall=0.466667, F1=0.531646
Ensemble test auc = 0.670202
Ensemble test auc = 0.670202
Ensemble test auc = 0.670202
Ensemble test auc = 0.670202
Ensemble test auc = 0.670202
5-fold cross validation
5-fold cross validation
5-fold cross validation
5-fold cross validation
5-fold cross validation
Seed 400 ==> test auc = 0.751680
Seed 400 ==> test auc = 0.751680
Seed 400 ==> test auc = 0.751680
Seed 400 ==> test auc = 0.751680
Seed 400 ==> test auc = 0.751680
Seed 401 ==> test auc = 0.738005
Seed 401 ==> test auc = 0.738005
Seed 401 ==> test auc = 0.738005
Seed 401 ==> test auc = 0.738005
Seed 401 ==> test auc = 0.738005
Seed 402 ==> test auc = 0.733730
Seed 402 ==> test auc = 0.733730
Seed 402 ==> test auc = 0.733730
Seed 402 ==> test auc = 0.733730
Seed 402 ==> test auc = 0.733730
Seed 403 ==> test auc = 0.748642
Seed 403 ==> test auc = 0.748642
Seed 403 ==> test auc = 0.748642
Seed 403 ==> test auc = 0.748642
Seed 403 ==> test auc = 0.748642
Seed 404 ==> test auc = 0.670202
Seed 404 ==> test auc = 0.670202
Seed 404 ==> test auc = 0.670202
Seed 404 ==> test auc = 0.670202
Seed 404 ==> test auc = 0.670202
Overall test auc = 0.728452 +/- 0.029864
Overall test auc = 0.728452 +/- 0.029864
Overall test auc = 0.728452 +/- 0.029864
Overall test auc = 0.728452 +/- 0.029864
Overall test auc = 0.728452 +/- 0.029864
